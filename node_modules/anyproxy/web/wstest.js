function initWs(wsPort = 3001, key = '/') {
  if(!WebSocket){
    throw (new Error('WebSocket is not supportted on this browser'));
  }

  const wsClient = new WebSocket(`wss://local.fishman.net:${wsPort}${key}`, 'sub',  {
    headers: {
      'custom-header': 'custom-header'
    }
  });

  wsClient.onerror = (error) => {
    console.error(error);
    message.error('error happened when setup websocket');
  };

  wsClient.onopen = (e) => {
    console.info('websocket opened: ', e);
  };

  wsClient.onclose = (e) => {
    console.info('websocket closed: ', e);
  };

  return wsClient;
}

const client = initWs('3001', '/test/socket');

client.onmessage = (event) => {
  const data = event.data;
  console.info('==> wss event ', data);
}


// Connection opened
client.onopen = (event) => {
  let i = 0;
  console.info('==> socket opened ', event);
  client.send('Hello Server, This is Nick!');
  setInterval(() => {
    i++;
    if(window.stopWs) {
      return;
    }
    client.send('Hello Server, This is Nick! Again,' + i);
    // client.send('Hello Server, This is Nick! Again,');
    // client.send('Hello Server, This is Nick! Again,');
    // client.send('Hello Server, This is Nick! Again,');
  }, 2000)
};

client.onerror = (e) => {
  console.error('==> error happened ', e);
}
